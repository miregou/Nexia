<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nexia: Mates - Pizarra Multiactividad</title>
    <link rel="stylesheet" href="css/styles.css?v=9.0">
    <link rel="stylesheet" href="css/responsive.css?v=1.0">
</head>

<body>
    <div id="app">
        <!-- VISTA MEN√ö -->
        <div id="view-menu" class="view active">
            <div class="app-header"
                style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); padding: 2rem 1rem;">
                <div class="header-top">
                    <button class="btn-curriculum" onclick="openCurriculumModal()"
                        style="background: white; color: #764ba2; border: 2px solid white; font-weight: bold;">üìã
                        Curr√≠culo</button>
                </div>
                <h1 class="app-title" style="color: white; text-shadow: 2px 2px 4px rgba(0,0,0,0.2);">üî¢ MATEAULA ‚ûï</h1>
                <p class="app-subtitle" style="color: rgba(255,255,255,0.95);">PIZARRA T√ÅCTIL DE MATEM√ÅTICAS</p>
            </div>
            <div class="menu-grid">
                <!-- Tarjetas de Men√∫ -->
                <div class="menu-card" onclick="startActivity('sumas')">
                    <div class="icon-box"><svg viewBox="0 0 100 100">
                            <rect x="10" y="30" width="35" height="35" rx="5" fill="#3b82f6" />
                            <rect x="55" y="30" width="35" height="35" rx="5" fill="#3b82f6" />
                            <path d="M48 40 v15 M40 47.5 h16" stroke="#1e293b" stroke-width="6"
                                stroke-linecap="round" />
                        </svg></div>
                    <span class="menu-title">Sumas</span>
                </div>
                <div class="menu-card" onclick="startActivity('restas')">
                    <div class="icon-box"><svg viewBox="0 0 100 100">
                            <rect x="20" y="30" width="60" height="30" rx="5" fill="#ef4444" />
                            <line x1="30" y1="45" x2="70" y2="45" stroke="white" stroke-width="8"
                                stroke-linecap="round" />
                        </svg></div>
                    <span class="menu-title">Restas</span>
                </div>
                <div class="menu-card" onclick="startActivity('comparar')">
                    <div class="icon-box"><svg viewBox="0 0 100 100">
                            <path d="M20 30 L80 50 L20 70" fill="none" stroke="#16a34a" stroke-width="10"
                                stroke-linecap="round" />
                            <circle cx="35" cy="45" r="5" fill="black" />
                        </svg></div>
                    <span class="menu-title">Compara</span>
                </div>
                <div class="menu-card" onclick="startActivity('antpost')">
                    <div class="icon-box"><svg viewBox="0 0 100 100">
                            <rect x="10" y="35" width="20" height="30" rx="4" fill="none" stroke="#cbd5e1"
                                stroke-width="2" stroke-dasharray="3 3" />
                            <rect x="40" y="30" width="20" height="40" rx="4" fill="#facc15" /><text x="50" y="55"
                                font-weight="bold" font-size="18" text-anchor="middle">5</text>
                            <rect x="70" y="35" width="20" height="30" rx="4" fill="none" stroke="#cbd5e1"
                                stroke-width="2" />
                        </svg></div>
                    <span class="menu-title">Ant. y Post.</span>
                </div>
                <div class="menu-card" onclick="startActivity('lectura')">
                    <div class="icon-box"><svg viewBox="0 0 100 100">
                            <path d="M10 40 h80 M10 60 h80" stroke="#e2e8f0" stroke-width="1" stroke-dasharray="2 2" />
                            <text x="15" y="55" font-family="cursive" font-size="28" fill="#1e293b">abc</text>
                        </svg></div>
                    <span class="menu-title">N¬∫ Escritos</span>
                </div>
                <div class="menu-card" onclick="startActivity('bloques')">
                    <div class="icon-box"><svg viewBox="0 0 100 100">
                            <rect x="25" y="10" width="15" height="80" rx="2" fill="#dc2626" />
                            <rect x="55" y="70" width="15" height="15" rx="2" fill="#2563eb" />
                        </svg></div>
                    <span class="menu-title">Bloques</span>
                </div>
                <div class="menu-card" onclick="startActivity('representa')">
                    <div class="icon-box"><svg viewBox="0 0 100 100">
                            <rect x="20" y="20" width="60" height="60" rx="10" fill="none" stroke="#3b82f6"
                                stroke-dasharray="5 5" stroke-width="3" />
                            <rect x="40" y="40" width="20" height="20" rx="2" fill="#2563eb" opacity="0.5" />
                        </svg></div>
                    <span class="menu-title">Representa</span>
                </div>
                <div class="menu-card" onclick="startActivity('camino1')">
                    <div class="icon-box"><svg viewBox="0 0 100 100">
                            <circle cx="20" cy="80" r="10" fill="#22c55e" />
                            <path d="M25 75 Q 50 50, 75 25" stroke="#f97316" stroke-width="4" stroke-dasharray="6 3"
                                fill="none" />
                        </svg></div>
                    <span class="menu-title">Camino</span>
                </div>
                <div class="menu-card" onclick="startActivity('batido')">
                    <div class="icon-box"><svg viewBox="0 0 100 100">
                            <path d="M30 20 L25 80 Q25 90 50 90 Q75 90 75 80 L70 20 Z" fill="#f0abfc" stroke="#a855f7"
                                stroke-width="2" />
                            <circle cx="40" cy="50" r="8" fill="#ef4444" />
                            <circle cx="55" cy="40" r="6" fill="#22c55e" />
                            <circle cx="50" cy="60" r="7" fill="#f97316" />
                        </svg></div>
                    <span class="menu-title">Batido</span>
                </div>
                <div class="menu-card" onclick="startActivity('vecinos')">
                    <div class="icon-box"><svg viewBox="0 0 100 100">
                            <rect x="5" y="40" width="25" height="35" fill="#fed7aa" stroke="#f97316"
                                stroke-width="2" />
                            <polygon points="17.5,25 5,40 30,40" fill="#dc2626" />
                            <rect x="37" y="35" width="26" height="45" fill="#fef08a" stroke="#eab308"
                                stroke-width="2" />
                            <polygon points="50,15 37,35 63,35" fill="#22c55e" />
                            <text x="50" y="65" font-size="16" font-weight="bold" text-anchor="middle">?</text>
                            <rect x="70" y="40" width="25" height="35" fill="#fed7aa" stroke="#f97316"
                                stroke-width="2" />
                            <polygon points="82.5,25 70,40 95,40" fill="#dc2626" />
                        </svg></div>
                    <span class="menu-title">Vecinos</span>
                </div>
                <div class="menu-card" onclick="startActivity('reloj')">
                    <div class="icon-box"><svg viewBox="0 0 100 100">
                            <circle cx="50" cy="50" r="40" fill="white" stroke="#3b82f6" stroke-width="4" />
                            <line x1="50" y1="50" x2="50" y2="25" stroke="#1e293b" stroke-width="3"
                                stroke-linecap="round" />
                            <line x1="50" y1="50" x2="70" y2="50" stroke="#1e293b" stroke-width="2"
                                stroke-linecap="round" />
                            <circle cx="50" cy="50" r="3" fill="#ef4444" />
                        </svg></div>
                    <span class="menu-title">Reloj</span>
                </div>
                <div class="menu-card" onclick="startActivity('puzzle')">
                    <div class="icon-box"><svg viewBox="0 0 100 100">
                            <rect x="10" y="35" width="22" height="30" rx="4" fill="#dbeafe" stroke="#3b82f6"
                                stroke-width="2" />
                            <text x="21" y="55" font-size="14" font-weight="bold" text-anchor="middle">3</text>
                            <rect x="39" y="35" width="22" height="30" rx="4" fill="#fef3c7" stroke="#f59e0b"
                                stroke-width="2" />
                            <text x="50" y="55" font-size="14" font-weight="bold" text-anchor="middle">?</text>
                            <rect x="68" y="35" width="22" height="30" rx="4" fill="#dbeafe" stroke="#3b82f6"
                                stroke-width="2" />
                            <text x="79" y="55" font-size="14" font-weight="bold" text-anchor="middle">5</text>
                        </svg></div>
                    <span class="menu-title">Puzzle</span>
                </div>
            </div>
        </div>

        <!-- VISTA JUEGO -->
        <div id="view-game" class="view">
            <div class="game-header">
                <div class="flex items-center gap-2">
                    <button onclick="goToMenu()" class="btn-nav">üè† MEN√ö</button>
                    <button class="btn-curriculum-game btn-nav" onclick="openCurriculumModal()">üìã Curr√≠culo</button>
                    <!-- Bot√≥n de Apoyo Visual (Sticks) - Se muestra v√≠a JS en actividades soportadas -->
                    <button id="toggle-sticks" onclick="toggleSticksIA()" class="btn-nav hidden"
                        style="font-size:9px;">APOYO: ON</button>
                </div>
                <div class="flex flex-col items-center">
                    <div id="game-title" class="font-bold uppercase"
                        style="font-size:0.8rem; letter-spacing: 1px; color:var(--white); background:rgba(0,0,0,0.1); padding:2px 8px; border-radius:4px;">
                        ACTIVIDAD</div>
                    <div id="page-badge" class="hidden page-indicator" style="font-size:10px; font-weight:bold;">PAG 1
                    </div>
                </div>
                <div class="flex gap-1" id="difficulty-selector">
                    <button onclick="setDifficulty(1)" id="diff-1" class="difficulty-btn active">N1</button>
                    <button onclick="setDifficulty(2)" id="diff-2" class="difficulty-btn">N2</button>
                    <button onclick="setDifficulty(3)" id="diff-3" class="difficulty-btn">N3</button>
                </div>
                <div class="score-badge">
                    <button onclick="openConfigModal()" class="btn-nav" style="padding:2px 6px; margin-right:4px;"
                        title="Configuraci√≥n">‚öôÔ∏è</button>
                    <button onclick="resetRound()" class="btn-nav"
                        style="padding:2px 6px; margin-right:4px;">üîÑ</button>
                    <div>‚≠ê <span id="score">0</span></div>
                </div>
            </div>

            <div id="game-container" class="main-layout">
                <div class="panel panel-left">
                    <div id="instruction" class="instruction-pill instruction-neutral">...</div>
                    <div id="exercise-container"></div>
                    <div id="dice-section"></div>
                </div>

                <div id="right-panel" class="panel">
                    <div id="pizarra-container">
                        <canvas id="canvas-pizarra"></canvas>
                        <div class="pizarra-label">PIZARRA M√ÅGICA ‚úçÔ∏è</div>
                        <button onclick="clearCanvas()" class="btn-clear">BORRAR üóëÔ∏è</button>
                    </div>
                    <div id="input-methods">
                        <div id="num-keypad" class="keypad-grid">
                            <button onclick="pressNum(1)" class="keypad-btn">1</button>
                            <button onclick="pressNum(2)" class="keypad-btn">2</button>
                            <button onclick="pressNum(3)" class="keypad-btn">3</button>
                            <button onclick="pressNum(4)" class="keypad-btn">4</button>
                            <button onclick="pressNum(5)" class="keypad-btn">5</button>
                            <button onclick="backspace()" class="keypad-btn btn-backspace">‚å´</button>
                            <button onclick="pressNum(6)" class="keypad-btn">6</button>
                            <button onclick="pressNum(7)" class="keypad-btn">7</button>
                            <button onclick="pressNum(8)" class="keypad-btn">8</button>
                            <button onclick="pressNum(9)" class="keypad-btn">9</button>
                            <button onclick="pressNum(0)" class="keypad-btn">0</button>
                            <button onclick="checkAnswerIA()" id="check-btn" class="keypad-btn btn-ok">OK</button>
                        </div>
                        <div id="symbol-keypad" class="hidden symbol-grid" style="gap:1.5rem;">
                            <!-- LESS THAN: Blue -->
                            <button onclick="checkComparison('<')" class="keypad-btn text-5xl" id="btn-lt"
                                style="color:var(--primary); font-weight:800; font-size:4rem;">&lt;</button>

                            <!-- EQUAL: Green -->
                            <button onclick="checkComparison('=')" class="keypad-btn text-5xl"
                                style="color:var(--success); font-weight:800; font-size:4rem;">=</button>

                            <!-- GREATER THAN: Red + Crocodile -->
                            <button onclick="checkComparison('>')"
                                class="keypad-btn flex-col items-center justify-center p-0" id="btn-gt"
                                style="color:var(--error); font-weight:800; line-height:1; gap:0;">
                                <span style="font-size:4rem;">&gt;</span>
                                <span style="font-size:2rem; margin-top:-10px;">üêä</span>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- MODAL IA -->
    <div id="gemini-modal"
        style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.5); z-index:100; align-items:center; justify-content:center;">
        <div id="gemini-content" class="animate-pop"
            style="background:white; padding:2rem; border-radius:1rem; max-width:500px; width:90%;">
            <h3 style="margin-top:0; color:var(--primary-dark);">‚ú® El Mago dice...</h3>
            <div id="ia-response-text"
                style="background:var(--off-white); padding:1rem; border-radius:0.5rem; margin:1rem 0; font-style:italic;">
                Cargando...</div>
            <div style="display:flex; justify-content:flex-end; gap:0.5rem;">
                <button onclick="readProblemIA()" class="btn-game-action"
                    style="font-size:0.8rem; padding:0.5rem 1rem;">‚ú® ESCUCHAR</button>
                <button onclick="closeModalIA()" class="btn-nav">CERRAR</button>
            </div>
        </div>
    </div>

    <!-- MODAL CURR√çCULO LOMLOE -->
    <div id="curriculum-modal" class="modal-overlay" style="display:none;">
        <div class="modal-content curriculum-modal-content">
            <h3>üìã Curr√≠culo LOMLOE - 1¬∫ Primaria</h3>
            <p class="curriculum-subtitle">√Årea de Matem√°ticas</p>

            <div class="curriculum-objectives" id="curriculum-list">
                <!-- Los objetivos se cargan din√°micamente desde JS -->
            </div>

            <button onclick="closeCurriculumModal()" class="btn-close-modal">CERRAR</button>
        </div>
    </div>

    <!-- MODAL CONFIGURACI√ìN ACTIVIDAD (Din√°mico) -->
    <div id="config-modal" class="modal-overlay" style="display:none;">
        <div class="modal-content">
            <h3 id="config-title">‚öôÔ∏è Configuraci√≥n</h3>
            <div id="config-options">
                <!-- Se carga v√≠a JS -->
            </div>
            <button onclick="closeConfigModal()" class="btn-game-action w-full" style="margin-top:1rem;">APLICAR Y
                EMPEZAR ‚ú®</button>
        </div>
    </div>

    <script src="js/app.js?v=9.1"></script>
</body>

</html>